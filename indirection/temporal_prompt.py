SYSTEM_PROMPT = """你是一位熟悉叙事结构与朱天心文体的文学分析助手。请阅读以下文本段落，识别其中**叙述时间与事件时间顺序不一致或时间跳动很大的句子（即「错时」）**，并标记其叙述类型与时间线索。

错时分为“追述”，即从当前叙述时间突然回溯到过去事件，和“预述”，在当前叙述中突然跳跃到未来某个时刻、描述未来事件，如「多年后」「未来的某一天」。**跳跃幅度一定要足够大，通常是跨越数年或数十年，且叙述的时间跨度明显超过一般叙事的流畅性。**

请特别留意这些结构：
- 典型的、时间跨度较大的错时句子；
- 某一事件在叙述上被放置于其实际时间顺序之外；
- 同一段话中出现多个不同时间层的混合（如“多年后回想当年…”），也就是既有追述也有预述的句子；
- 由于写作时间是90年代，所以讲述一九九零年代（民国八十几年）的事件是并不算错时。

你的任务是标出所有存在错时的句子，并填写以下字段：
- `"original"`：完整原句，保留上下文结构；
- `"time_expression"`：表明时间跳跃的关键词或语法结构（可为明示或暗示）；
- `"type"`：标明是 `"追述"` 或 `"预述"`；
- `"narrative_perspective"`：句子的叙事视角，填写 `"第一人称"`、`"第二人称"` 或 `"第三人称"`；
- `"reason"`：简要说明为何判断为错时，并解释时间偏移与叙述角度的关系。

请严格以 JSON 数组格式输出结果，不要输出额外说明。
请仔细选择具有错时特征或时间大幅跳跃的句子，如果发现有很多时间词但不是错时的句子，请回答“不是错时。”并给出理由。
"""

EXAMPLE_ONE = """红布幅，上书「本村全体支持×号候选人×××」，衬著蓝色的天空迎风猎猎作响，好像每隔几年总要张挂那么几天，她要到差不多二十年后，离她拥有民众投票权十几年以后，才百感交集回想起那情景，并初次投下与那红布条不同政党的一票。

她盘桓在他们周围，像一只外来的陌生的鸟，试图想加入他们，多想念与他们一起厮混扭打时的体温汗臭，乃至中飯吃得太飽所發自肺腑打的嗝兒味，江西人的阿丁的嗝味其實比四川人的培培要辛辣得多，浙江人的汪家小孩總是臭烘烘的糟白魚、蒸臭豆腐味，廣東人的雅雅和她哥哥們總是粥的酸酵味，很奇怪他們都絕口不說「稀飯」而說粥，愛吃的「廣柑」就是柳丁。更不要說張家莫家小孩山"""
RESPONSE_ONE = """
[
  {
    "original": "她要到差不多二十年后，离她拥有公民投票十几年以后，才百感交集回想起那情景，并初次投下与那红布条不同政党的一票。",
    "time_expression": ["二十年后", "十几年以后", "才回想"],
    "type": ["预述", "追述"],
    "narrative_perspective": ["第三人称"],
    "reason": "叙述者从过去的语境跳到未来的某个时刻再回望过去的情境，是典型的双重错时；视角距离人物内在，有反思性。"
  },
  {
    "original": "她盘桓在他们周围，像一只外来的陌生的鸟，试图想加入他们，多想念与他们一起厮混扭打时的体温汗臭。",
    "time_expression": ["多想念", "厮混扭打时"],
    "type": ["追述"],
    "narrative_perspective": ["第三人称"],
    "reason": "此句将想象中的「她」置于过去的情境中，回忆与他们的互动，表达对过去的怀念和渴望。"
  }
]

"""

EXAMPLE_TWO = """她甚至认识了一大堆本省男孩子，深深迷惑于他们的笃定，大异于她的兄弟姊妹们，她所熟悉的兄弟姊妹们，基于各种奇怪难言的原因，没有一人没有过想离开这个地方的念头，书念得好的，家里也愿意借债支持的就出去深造，念不出的就用跑船的方式离开；大女孩子念不来书的，拜越战之赐，好多嫁了美军得以出去。很多年以后，当她不耐烦老被等同于外来政权指责的「从未把这个岛视为久居之地」时，曾认真回想并思索，的确为什么他们没有把这块土地视为此生落脚处，起码在那些年间——"""
RESPONSE_TWO = """
[
  {
    "original": "很多年以后，当她不耐烦老被等同于外来政权指责的『从未把这个岛是为久居之地』时，曾认真回想并思索，的确为什么他们没有把这块土地视为此生落脚处。",
    "time_expression": ["很多年以后", "曾认真回想"],
    "type": ["预述", "追述"],
    "narrative_perspective": ["第三人称"],
    "reason": "「很多年以后」设立未来视角，但在同句中又使用「回想」构成时间回返，预述与追述交织，表现心理与记忆的分裂性。"
  }
]
"""

EXAMPLE_THREE = """那天午后，天气闷得发紧，雷声远远地在山背后打转，像是在预告什么将来不会降临的东西。你和她躲在眷村外婆家的屋檐下，谁也没说话，只是咬著从冰箱挖出的凤梨罐头，汤汁滴在膝盖上，黏黏的。对面巷子的广播器传来《夜来香》的前奏，旧日电台声音里的颤音总是让你莫名心烦。

可能得好些年后，你才找到适切的文字语言，描述你们那几个午后坐在眷村屋檐下、彼此沉默却无比亲密的样子。那时你只觉得闷热，如今才知那叫寂寥，也叫安慰。"""
RESPONSE_THREE = """
[
  {
    "original": "可能得好些年后，你才找到适切的文字语言，描述你们那几个午后坐在眷村屋檐下、彼此沉默却无比亲密的样子。",
    "time_expression": ["可能得好些年后"],
    "type": ["预述"],
    "narrative_perspective": "第二人称",
    "reason": "将「你」的当下经验延迟至未来理解，展现记忆的非线性结构与叙事主体的时间分裂。"
  }
]
"""

EXAMPLE_FOUR = """依岁时，大晦日除夜，你于清水寺前静穆心情聆听僧侣们撞那一四七八年造迄今的古钟；次日，平安神宫初诣，神宫境内前日的篝火余烟给冻得直直的；七日内还没离去的话，便去上贺茂神社观看单调的白苍马奏覽神事，神前供养着七草和七草粥；花祭第二个日曜日，醍醐寺的太合花见行列，重现庆长三年暮年的丰臣秀吉最后一次偕妻北政所、妾淀君和百官在醍醐寺的赏花大会；月末，伏见稻荷大社的稻荷祭，朱涂飞檐梁柱衬着墨绿的黑松，鼓笛尺八终日不歇；五月葵祭，为了躲梅雨季，你从未参加过；夏末，爱宕山下化野念佛寺的千灯供养；九月杪，本能寺僧在大堰川施饿鬼法会；十月终，北野天满宫余香祭：二十二日，Ａ的生日。"""
RESPONSE_FOUR = """不是错时。这段文字是顺着农历或节庆时间推进的，从“大晦日”→“初诣”→“七草节”→“花祭”→“稻荷祭”→“夏末”→“秋末”，是顺序列举，不是时间跳跃；虽然涉及一年中的多个时间点，但它们都属于同一个时间框架内（一个典型年份），没有出现“突然跳到很多年后”或“回忆数十年前”的叙述跳跃。"""

EXAMPLE_FIVE = """千年前的人为你探过路，是埃及的国王尼科，他派擅航海的腓尼基人乘船出发，命令他们在回航时得经过直布罗陀海峡的海克力斯柱，最后再从多岛海回埃及。"""
RESPONSE_FIVE = """不是错时。虽然提到了“千年前”，但这是在引用历史知识或神话传说，不是小说叙事中主角经历的时间跳跃；这句话是在描写“前人如何为你铺路”，是一种文化象征或知识性引用，和你自己的故事时间无直接关系。"""

default = [
    {"role": "user", "content": EXAMPLE_ONE},
    {"role": "assistant", "content": RESPONSE_ONE},
    {"role": "user", "content": EXAMPLE_FOUR},
    {"role": "assistant", "content": RESPONSE_FOUR},
    {"role": "user", "content": EXAMPLE_THREE},
    {"role": "assistant", "content": RESPONSE_THREE},
    {"role": "user", "content": EXAMPLE_TWO},
    {"role": "assistant", "content": RESPONSE_TWO},
    {"role": "user", "content": EXAMPLE_FIVE},
    {"role": "assistant", "content": RESPONSE_FIVE}
]


def prompt_formatter(text):

    prompt = [
        {"role": "system", "content": SYSTEM_PROMPT},
        *default,
        {"role": "user", "content": text},
    ]
    
    return prompt